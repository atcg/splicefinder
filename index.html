<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="description" content="SpliceFinder : ">

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>SpliceFinder</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/atcg/splicefinder">View on GitHub</a>

          <h1 id="project_title">SpliceFinder</h1>
          <h2 id="project_tagline"></h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/atcg/splicefinder/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/atcg/splicefinder/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h1>
<a id="splicefinder" class="anchor" href="#splicefinder" aria-hidden="true"><span class="octicon octicon-link"></span></a>Splicefinder</h1>

<p>This is the walkthrough and code that accompanies "Conservative prediction of intron splice sites for the design of exon-capture arrays."</p>

<h3>
<a id="step-1-download-mouse-data-from-ensembl" class="anchor" href="#step-1-download-mouse-data-from-ensembl" aria-hidden="true"><span class="octicon octicon-link"></span></a>Step 1: Download mouse data from Ensembl</h3>

<hr>

<p>Connect to the server, navigate to the proper folder, and download data in bash:</p>

<div class="highlight highlight-bash"><pre>ssh maven
<span class="pl-c1">cd</span> /mnt/Data1/spliceFinder
mkdir ensembl
<span class="pl-c1">cd</span> ensembl
wget ftp://ftp.ensembl.org/pub/release-80/fasta/mus_musculus/cdna/Mus_musculus.GRCm38.cdna.all.fa.gz

wget ftp://ftp.ensembl.org/pub/release-80/fasta/mus_musculus/cdna/README

gunzip Mus_musculus.GRCm38.cdna.all.fa.gz</pre></div>

<p>After downloading the data, <code>get_fasta_lengths.py --input Mus_musculus.GRCm38.cdna.all.fa</code> gives the following output:</p>

<pre lang="text"><code>Reads:      90,891
Bp:     168,812,502
Avg. len:   1,857.30712612
STDERR len: 6.5011432467
Min. len:   9
Max. len:   106,824
Median len: 1,078.0
Contigs &gt; 1kb:  47,261
</code></pre>

<p>These represent the latest set of mouse cDNAs from ENSEMBL. We are first going to randomly subset these into fewer than 90,891, because we are going to run many analyses on these sets, mapping to multiple genomes (which can be slow). Let's see what they look like:</p>

<pre lang="text"><code>head --lines 6 Mus_musculus.GRCm38.cdna.all.fa
&gt;ENSMUST00000196221 havana_ig_gene:known chromosome:GRCm38:14:54113468:54113476:1 gene:ENSMUSG00000096749 gene_biotype:TR_D_gene transcript_biotype:TR_D_gene
ATGGCATAT
&gt;ENSMUST00000179664 ensembl_ig_gene:known chromosome:GRCm38:14:54113468:54113478:1 gene:ENSMUSG00000096749 gene_biotype:TR_D_gene transcript_biotype:TR_D_gene
ATGGCATATCA
&gt;ENSMUST00000177564 ensembl_havana_ig_gene:known chromosome:GRCm38:14:54122226:54122241:1 gene:ENSMUSG00000096176 gene_biotype:TR_D_gene transcript_biotype:TR_D_gene
ATCGGAGGGATACGAG
</code></pre>

<p>Looking at this output tells us a few things. First of all, some of the transcripts are extremely short. Since the purpose of this method is to infer contiguous genomic sequence chunks long enough to use target enrichment array design, we know we'll want to filter out all cDNAs that are too short to actually yield a target. We'll arbitrarily set this limit at 200bp for now. The following script will output all sequences longer than 199bp:</p>

<div class="highlight highlight-perl"><pre><span class="pl-c">#!/usr/bin/perl</span>

<span class="pl-c">#filterUnder200.pl</span>

<span class="pl-k">use</span> strict;
<span class="pl-k">use</span> warnings;
<span class="pl-k">use</span> Bio::SeqIO;

<span class="pl-k">my</span> <span class="pl-smi">$seqIn</span> = Bio::SeqIO<span class="pl-k">-&gt;</span>new(-<span class="pl-c1">file</span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>Mus_musculus.GRCm38.cdna.all.fa<span class="pl-pds">"</span></span>,
                            -<span class="pl-c1">format</span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">'</span>fasta<span class="pl-pds">'</span></span>);
<span class="pl-k">my</span> <span class="pl-smi">$seqOut</span> = Bio::SeqIO<span class="pl-k">-&gt;</span>new(-<span class="pl-c1">file</span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>&gt;mmGRCm38.cdna.200bpPlus.fa<span class="pl-pds">"</span></span>,
                             -<span class="pl-c1">format</span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>fasta<span class="pl-pds">"</span></span>);

<span class="pl-k">while</span> (<span class="pl-k">my</span> <span class="pl-smi">$seq</span> = <span class="pl-smi">$seqIn</span><span class="pl-k">-&gt;</span>next_seq()) {
    <span class="pl-k">if</span> (<span class="pl-smi">$seq</span><span class="pl-k">-&gt;</span><span class="pl-c1">length</span>() &gt; 199) {
        <span class="pl-smi">$seqOut</span><span class="pl-k">-&gt;</span>write_seq(<span class="pl-smi">$seq</span>);
    }
}</pre></div>

<p>After running, we have:</p>

<pre lang="text"><code>get_fasta_lengths.py --input mmGRCm38.cdna.200bpPlus.fa 
Reads:          90,060
Bp:             168,702,266
Avg. len:       1,873.22080835
STDERR len:     6.53762906167
Min. len:       200
Max. len:       106,824
Median len:     1,098.0
Contigs &gt; 1kb:  47,261
</code></pre>

<p>That didn't very many, so we'll have to reduce further. You'll notice in the fasta headers that there is a gene name in the fourth column. Let's find out how many unique gene names there are total:</p>

<pre lang="text"><code>grep "gene:" mmGRCm38.cdna.200bpPlus.fa | awk '{print $4}' | uniq -c | wc -l
30722
</code></pre>

<p>Randomly choosing one transcript from each gene name seems like one good way to reduce the dataset without losing genomic coverage. But choosing the longest cDNA from each gene name might give us better success at mapping to other genomes. Let's do that with the following script:</p>

<div class="highlight highlight-perl"><pre><span class="pl-c">#!/usr/bin/perl</span>

<span class="pl-c"># longestFromGenes.pl</span>

<span class="pl-k">use</span> strict;
<span class="pl-k">use</span> warnings;
<span class="pl-k">use</span> Bio::SeqIO;


<span class="pl-k">my</span> <span class="pl-smi">%seqHash</span>;
<span class="pl-k">my</span> <span class="pl-smi">$seqIn1</span> = Bio::SeqIO<span class="pl-k">-&gt;</span>new(-<span class="pl-c1">file</span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>mmGRCm38.cdna.200bpPlus.fa<span class="pl-pds">"</span></span>,
                             -<span class="pl-c1">format</span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>fasta<span class="pl-pds">"</span></span>);
<span class="pl-k">my</span> <span class="pl-smi">$seqOut</span> = Bio::SeqIO<span class="pl-k">-&gt;</span>new(-<span class="pl-c1">file</span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>&gt;mmGRCm38.cdna.longestFromGenes.fa<span class="pl-pds">"</span></span>,
                             -<span class="pl-c1">format</span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>fasta<span class="pl-pds">"</span></span>);

<span class="pl-k">while</span> (<span class="pl-k">my</span> <span class="pl-smi">$seq</span> = <span class="pl-smi">$seqIn1</span><span class="pl-k">-&gt;</span>next_seq()) {
    <span class="pl-k">if</span> (<span class="pl-smi">$seq</span><span class="pl-k">-&gt;</span>desc() =~ <span class="pl-sr"><span class="pl-pds">/</span>.*gene<span class="pl-cce">\:</span>(<span class="pl-cce">\S</span>+)<span class="pl-cce">\s</span><span class="pl-pds">/</span></span>) {
        <span class="pl-c"># Each transcript is associated with a gene name, and has a</span>
        <span class="pl-c"># hash value equal to its length</span>
        <span class="pl-k">my</span> <span class="pl-smi">$geneName</span> = <span class="pl-smi">$1</span>;
        <span class="pl-smi">$seqHash</span>{<span class="pl-smi">$geneName</span>}{<span class="pl-smi">$seq</span><span class="pl-k">-&gt;</span>display_id()} = <span class="pl-smi">$seq</span>;
    }
}

<span class="pl-k">foreach</span> <span class="pl-k">my</span> <span class="pl-smi">$gene</span> (<span class="pl-c1">sort</span> <span class="pl-c1">keys</span> <span class="pl-smi">%seqHash</span>) {
    <span class="pl-k">my</span> <span class="pl-smi">$longestID</span>;
    <span class="pl-k">my</span> <span class="pl-smi">$longestLength</span> = 0;
    <span class="pl-k">foreach</span> <span class="pl-k">my</span> <span class="pl-smi">$transcript</span> (<span class="pl-c1">sort</span> <span class="pl-c1">keys</span> %{<span class="pl-smi">$seqHash</span>{<span class="pl-smi">$gene</span>}}) {
        <span class="pl-k">if</span> (<span class="pl-smi">$seqHash</span>{<span class="pl-smi">$gene</span>}{<span class="pl-smi">$transcript</span>}<span class="pl-k">-&gt;</span><span class="pl-c1">length</span>() &gt; <span class="pl-smi">$longestLength</span>) {
            <span class="pl-smi">$longestID</span> = <span class="pl-smi">$transcript</span>;
            <span class="pl-smi">$longestLength</span> = <span class="pl-smi">$seqHash</span>{<span class="pl-smi">$gene</span>}{<span class="pl-smi">$transcript</span>}<span class="pl-k">-&gt;</span><span class="pl-c1">length</span>();
        }
    }
    <span class="pl-smi">$seqOut</span><span class="pl-k">-&gt;</span>write_seq(<span class="pl-smi">$seqHash</span>{<span class="pl-smi">$gene</span>}{<span class="pl-smi">$longestID</span>})
}</pre></div>

<p>This should get the list down to 30,722, and the average length should go up (it was 1,873 bp before).</p>

<pre lang="text"><code>get_fasta_lengths.py --input mmGRCm38.cdna.longestFromGenes.fa 
Reads:          30,722
Bp:             73,817,860
Avg. len:       2,402.76869995
STDERR len:     13.0889977284
Min. len:       200
Max. len:       106,824
Median len:     1,734.0
Contigs &gt; 1kb:  20,279
</code></pre>

<p>Looking good! I think 30,722 transcripts is still a little high though, so I will subset the dataset down to 10,000 transcripts randomly.</p>

<div class="highlight highlight-perl"><pre><span class="pl-c">#!/usr/bin/perl</span>
<span class="pl-k">use</span> strict;
<span class="pl-k">use</span> warnings;
<span class="pl-k">use</span> List::Util <span class="pl-s"><span class="pl-pds">qw/</span>shuffle<span class="pl-pds">/</span></span>;

<span class="pl-c">#random10k.pl</span>

<span class="pl-k">my</span> <span class="pl-smi">$seqIn</span> = Bio::SeqIO<span class="pl-k">-&gt;</span>new(-<span class="pl-c1">file</span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>mmGRCm38.cdna.longestFromGenes.fa<span class="pl-pds">"</span></span>,
                            -<span class="pl-c1">format</span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>fasta<span class="pl-pds">"</span></span>);
<span class="pl-k">my</span> <span class="pl-smi">$seqOut</span> = Bio::SeqIO<span class="pl-k">-&gt;</span>new(-<span class="pl-c1">file</span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>&gt;mmGRCm38.cdna.rand10kLongest.fa<span class="pl-pds">"</span></span>,
                            -<span class="pl-c1">format</span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>fasta<span class="pl-pds">"</span></span>);

<span class="pl-k">my</span> <span class="pl-smi">@seqArray</span>;
<span class="pl-k">while</span> (<span class="pl-k">my</span> <span class="pl-smi">$seq</span> = <span class="pl-smi">$seqIn</span><span class="pl-k">-&gt;</span>next_seq()) {
    <span class="pl-c1">push</span>(<span class="pl-smi">@seqArray</span>, <span class="pl-smi">$seq</span>);
}

<span class="pl-k">my</span> <span class="pl-smi">@shuffledSeqs</span> = shuffle(<span class="pl-smi">@seqArray</span>);

<span class="pl-k">my</span> <span class="pl-smi">$counter</span> = 0;
<span class="pl-k">while</span> (<span class="pl-smi">$counter</span> &lt; 10000) {
    <span class="pl-smi">$seqOut</span><span class="pl-k">-&gt;</span>write_seq(<span class="pl-smi">$shuffledSeqs</span>[<span class="pl-smi">$counter</span>]);
    <span class="pl-smi">$counter</span>++;
}</pre></div>

<p>That should give us 10,000 transcripts from 10,000 distinct genes scattered throughout the mouse genome.</p>

<pre lang="text"><code>get_fasta_lengths.py --input mmGRCm38.cdna.rand10kLongest.fa
Reads:      10,000
Bp:     23,940,240
Avg. len:   2,394.024
STDERR len: 21.8914472689
Min. len:   200
Max. len:   22,489
Median len: 1,732.0
Contigs &gt; 1kb:  6,651
</code></pre>

<p>Excellent. Now we're ready to set up some mapping. In this experiment, we're going to want to map to approximately 10 genomes of varying sequence divergence from the mouse genome. For now, let's try the following genomes:</p>

<ol>
<li>Rat (<em>Rattus norvegicus</em>)</li>
<li>Human (<em>Homo sapiens</em>)</li>
<li>Pig (<em>Sus scrofa</em>)</li>
<li>Elephant (<em>Loxodonta_africana</em>)</li>
<li>Playtpus (<em>Ornithorynchus anatinus</em>)</li>
<li>Chicken (<em>Gallus gallus</em>)</li>
<li><em>Xenopus tropicalis</em></li>
<li><em>Anolis carolinensis</em></li>
<li>Coelacanth (<em>Latimeria chalumnae</em>)</li>
<li>Puffer fish (<em>Takifugu rubripes</em>)</li>
<li>Sea lamprey (<em>Petromyzon marinus</em>)</li>
<li>Sea urchin (<em>Strongylocentrotus purpuratus</em>)</li>
</ol>

<p>Let's download those genomes, getting the unmasked primary assembly if possible, otherwise taking the unmasked top-level assembly:</p>

<div class="highlight highlight-bash"><pre>mkdir genomes
<span class="pl-c1">cd</span> genomes
wget ftp://ftp.ensembl.org/pub/release-80/fasta/rattus_norvegicus/dna/Rattus_norvegicus.Rnor_6.0.dna.toplevel.fa.gz
wget ftp://ftp.ensembl.org/pub/release-80/fasta/homo_sapiens/dna/Homo_sapiens.GRCh38.dna.primary_assembly.fa.gz
wget ftp://ftp.ensembl.org/pub/release-80/fasta/sus_scrofa/dna/Sus_scrofa.Sscrofa10.2.dna.toplevel.fa.gz
wget ftp://ftp.ensembl.org/pub/release-80/fasta/loxodonta_africana/dna/Loxodonta_africana.loxAfr3.dna.toplevel.fa.gz
wget ftp://ftp.ensembl.org/pub/release-80/fasta/ornithorhynchus_anatinus/dna/Ornithorhynchus_anatinus.OANA5.dna.toplevel.fa.gz
wget ftp://ftp.ensembl.org/pub/release-80/fasta/gallus_gallus/dna/Gallus_gallus.Galgal4.dna.toplevel.fa.gz
wget ftp://ftp.ensembl.org/pub/release-80/fasta/xenopus_tropicalis/dna/Xenopus_tropicalis.JGI_4.2.dna.toplevel.fa.gz
wget ftp://ftp.ensembl.org/pub/release-80/fasta/anolis_carolinensis/dna/Anolis_carolinensis.AnoCar2.0.dna.toplevel.fa.gz
wget ftp://ftp.ensembl.org/pub/release-80/fasta/latimeria_chalumnae/dna/Latimeria_chalumnae.LatCha1.dna.toplevel.fa.gz
wget ftp://ftp.ensembl.org/pub/release-80/fasta/takifugu_rubripes/dna/Takifugu_rubripes.FUGU4.dna.toplevel.fa.gz
wget ftp://ftp.ensembl.org/pub/release-80/fasta/petromyzon_marinus/dna/Petromyzon_marinus.Pmarinus_7.0.dna.toplevel.fa.gz
wget ftp://ftp.ensemblgenomes.org/pub/metazoa/release-26/fasta/strongylocentrotus_purpuratus/dna/Strongylocentrotus_purpuratus.GCA_000002235.2.26.dna.toplevel.fa.gz

gunzip <span class="pl-k">*</span>.gz</pre></div>

<p>We'll also need the full collection of protein sequences from these organisms:</p>

<div class="highlight highlight-bash"><pre>mkdir proteins
<span class="pl-c1">cd</span> proteins

wget ftp://ftp.ensembl.org/pub/release-80/fasta/rattus_norvegicus/pep/Rattus_norvegicus.Rnor_6.0.pep.all.fa.gz
wget ftp://ftp.ensembl.org/pub/release-80/fasta/homo_sapiens/pep/Homo_sapiens.GRCh38.pep.all.fa.gz
wget ftp://ftp.ensembl.org/pub/release-80/fasta/sus_scrofa/pep/Sus_scrofa.Sscrofa10.2.pep.all.fa.gz
wget ftp://ftp.ensembl.org/pub/release-80/fasta/loxodonta_africana/pep/Loxodonta_africana.loxAfr3.pep.all.fa.gz
wget ftp://ftp.ensembl.org/pub/release-80/fasta/ornithorhynchus_anatinus/pep/Ornithorhynchus_anatinus.OANA5.pep.all.fa.gz
wget ftp://ftp.ensembl.org/pub/release-80/fasta/gallus_gallus/pep/Gallus_gallus.Galgal4.pep.all.fa.gz
wget ftp://ftp.ensembl.org/pub/release-80/fasta/xenopus_tropicalis/pep/Xenopus_tropicalis.JGI_4.2.pep.all.fa.gz
wget ftp://ftp.ensembl.org/pub/release-80/fasta/anolis_carolinensis/pep/Anolis_carolinensis.AnoCar2.0.pep.all.fa.gz
wget ftp://ftp.ensembl.org/pub/release-80/fasta/latimeria_chalumnae/pep/Latimeria_chalumnae.LatCha1.pep.all.fa.gz
wget ftp://ftp.ensembl.org/pub/release-80/fasta/takifugu_rubripes/pep/Takifugu_rubripes.FUGU4.pep.all.fa.gz
wget ftp://ftp.ensembl.org/pub/release-80/fasta/petromyzon_marinus/pep/Petromyzon_marinus.Pmarinus_7.0.pep.all.fa.gz
wget ftp://ftp.ensemblgenomes.org/pub/metazoa/release-26/fasta/strongylocentrotus_purpuratus/pep/Strongylocentrotus_purpuratus.GCA_000002235.2.26.pep.all.fa.gz

gunzip <span class="pl-k">*</span></pre></div>

<p>We're going to use exonerate protein2genome to map all of these proteins to their respective genomes.</p>

<div class="highlight highlight-bash"><pre><span class="pl-c1">cd</span> ../

fasta2esd --softmask no Loxodonta_africana.loxAfr3.dna.toplevel.fa Loxodonta_africana.loxAfr3.dna.toplevel.esd
fasta2esd --softmask no Ornithorhynchus_anatinus.OANA5.dna.toplevel.fa Ornithorhynchus_anatinus.OANA5.dna.toplevel.esd
fasta2esd --softmask no Strongylocentrotus_purpuratus.GCA_000002235.2.26.dna.toplevel.fa Strongylocentrotus_purpuratus.GCA_000002235.2.26.dna.toplevel.esd
fasta2esd --softmask no Petromyzon_marinus.Pmarinus_7.0.dna.toplevel.fa Petromyzon_marinus.Pmarinus_7.0.dna.toplevel.esd
fasta2esd --softmask no Takifugu_rubripes.FUGU4.dna.toplevel.fa Takifugu_rubripes.FUGU4.dna.toplevel.esd
fasta2esd --softmask no Latimeria_chalumnae.LatCha1.dna.toplevel.fa Latimeria_chalumnae.LatCha1.dna.toplevel.esd
fasta2esd --softmask no Anolis_carolinensis.AnoCar2.0.dna.toplevel.fa Anolis_carolinensis.AnoCar2.0.dna.toplevel.esd
fasta2esd --softmask no Xenopus_tropicalis.JGI_4.2.dna.toplevel.fa Xenopus_tropicalis.JGI_4.2.dna.toplevel.esd
fasta2esd --softmask no Gallus_gallus.Galgal4.dna.toplevel.fa Gallus_gallus.Galgal4.dna.toplevel.esd
fasta2esd --softmask no Sus_scrofa.Sscrofa10.2.dna.toplevel.fa Sus_scrofa.Sscrofa10.2.dna.toplevel.esd
fasta2esd --softmask no Homo_sapiens.GRCh38.dna.primary_assembly.fa Homo_sapiens.GRCh38.dna.primary_assembly.esd
fasta2esd --softmask no Rattus_norvegicus.Rnor_6.0.dna.toplevel.fa Rattus_norvegicus.Rnor_6.0.dna.toplevel.esd

esd2esi Loxodonta_africana.loxAfr3.dna.toplevel.esd Loxodonta_africana.loxAfr3.dna.toplevel.trans.esi --translate yes --memorylimit 25600
esd2esi Ornithorhynchus_anatinus.OANA5.dna.toplevel.esd Ornithorhynchus_anatinus.OANA5.dna.toplevel.trans.esi --translate yes --memorylimit 25600
esd2esi Strongylocentrotus_purpuratus.GCA_000002235.2.26.dna.toplevel.esd Strongylocentrotus_purpuratus.GCA_000002235.2.26.dna.toplevel.trans.esi --translate yes --memorylimit 25600
esd2esi Petromyzon_marinus.Pmarinus_7.0.dna.toplevel.esd Petromyzon_marinus.Pmarinus_7.0.dna.toplevel.trans.esi --translate yes --memorylimit 25600
esd2esi Takifugu_rubripes.FUGU4.dna.toplevel.esd Takifugu_rubripes.FUGU4.dna.toplevel.trans.esi --translate yes --memorylimit 25600
esd2esi Latimeria_chalumnae.LatCha1.dna.toplevel.esd Latimeria_chalumnae.LatCha1.dna.toplevel.trans.esi --translate yes --memorylimit 25600
esd2esi Anolis_carolinensis.AnoCar2.0.dna.toplevel.esd Anolis_carolinensis.AnoCar2.0.dna.toplevel.trans.esi --translate yes --memorylimit 25600
esd2esi Xenopus_tropicalis.JGI_4.2.dna.toplevel.esd Xenopus_tropicalis.JGI_4.2.dna.toplevel.trans.esi --translate yes --memorylimit 25600
esd2esi Gallus_gallus.Galgal4.dna.toplevel.esd Gallus_gallus.Galgal4.dna.toplevel.trans.esi --translate yes --memorylimit 25600
esd2esi Sus_scrofa.Sscrofa10.2.dna.toplevel.esd Sus_scrofa.Sscrofa10.2.dna.toplevel.trans.esi --translate yes --memorylimit 25600
esd2esi Homo_sapiens.GRCh38.dna.primary_assembly.esd Homo_sapiens.GRCh38.dna.primary_assembly.trans.esi --translate yes --memorylimit 25600
esd2esi Rattus_norvegicus.Rnor_6.0.dna.toplevel.esd Rattus_norvegicus.Rnor_6.0.dna.toplevel.trans.esi --translate yes --memorylimit 25600</pre></div>

<p>The above will take several hours. We want to map the orthologous proteins from each species to their own reference genomes. So, we will need to find the orthologous proteins from each species. First we'll make blast databases from each protein set:</p>

<div class="highlight highlight-bash"><pre><span class="pl-c1">cd</span> proteins
<span class="pl-k">for</span> <span class="pl-smi">i</span> <span class="pl-k">in</span> <span class="pl-k">*</span>.pep.all.fa<span class="pl-k">;</span> <span class="pl-k">do</span> makeblastdb -<span class="pl-k">in</span> <span class="pl-smi">$i</span> -dbtype prot<span class="pl-k">;</span> <span class="pl-k">done</span></pre></div>

<p>Now we'll iterate through each of the protein sets and blastx the mouse cDNAs to each, only outputting the best match:</p>

<div class="highlight highlight-bash"><pre><span class="pl-k">for</span> <span class="pl-smi">i</span> <span class="pl-k">in</span> <span class="pl-k">*</span>.pep.all.fa<span class="pl-k">;</span> <span class="pl-k">do</span> OUTFILE=<span class="pl-smi">$i</span><span class="pl-s"><span class="pl-pds">"</span>.proteinMatches<span class="pl-pds">"</span></span><span class="pl-k">;</span> blastx -db <span class="pl-smi">$i</span> -query ../../mmGRCm38.cdna.rand10kLongest.fa -outfmt 6 -max_target_seqs 1 -num_threads 10 -out <span class="pl-smi">$OUTFILE</span> <span class="pl-k">;</span> <span class="pl-k">done</span></pre></div>

<p>The blastx'ing will also take a few hours.</p>

<p>After the blastx is done, we'll parse the blastx results to pull out all the protein sequences that matched and store them into a new file for exonerate protein2genome mapping:</p>

<div class="highlight highlight-perl"><pre><span class="pl-c">#!/usr/bin/perl</span>

<span class="pl-c"># pullOutMatchingProteins.pl</span>

<span class="pl-k">use</span> strict;
<span class="pl-k">use</span> warnings;
<span class="pl-k">use</span> Bio::SeqIO;
<span class="pl-k">use</span> Bio::SearchIO;

<span class="pl-k">my</span> <span class="pl-smi">@speciesArray</span> = (<span class="pl-s"><span class="pl-pds">"</span>Strongylocentrotus_purpuratus.GCA_000002235.2.26<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>Petromyzon_marinus.Pmarinus_7.0<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>Takifugu_rubripes.FUGU4<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>Latimeria_chalumnae.LatCha1<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>Anolis_carolinensis.AnoCar2.0<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>Xenopus_tropicalis.JGI_4.2<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>Gallus_gallus.Galgal4<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>Ornithorhynchus_anatinus.OANA5<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>Loxodonta_africana.loxAfr3<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>Sus_scrofa.Sscrofa10.2<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>Homo_sapiens.GRCh38<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>Rattus_norvegicus.Rnor_6.0<span class="pl-pds">"</span></span>);

<span class="pl-k">foreach</span> <span class="pl-k">my</span> <span class="pl-smi">$species</span> (<span class="pl-smi">@speciesArray</span>) {
    <span class="pl-k">my</span> <span class="pl-smi">$proteinFasta</span> = <span class="pl-smi">$species</span> . <span class="pl-s"><span class="pl-pds">"</span>.pep.all.fa<span class="pl-pds">"</span></span>;

    <span class="pl-k">my</span> <span class="pl-smi">%protHash</span>;
    <span class="pl-k">my</span> <span class="pl-smi">$seqIn</span> = Bio::SeqIO<span class="pl-k">-&gt;</span>new(-<span class="pl-c1">file</span> <span class="pl-k">=&gt;</span> <span class="pl-smi">$proteinFasta</span>,
                                -<span class="pl-c1">format</span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">'</span>fasta<span class="pl-pds">'</span></span>);
    <span class="pl-k">while</span> (<span class="pl-k">my</span> <span class="pl-smi">$seq</span> = <span class="pl-smi">$seqIn</span><span class="pl-k">-&gt;</span>next_seq()) {
        <span class="pl-smi">$protHash</span>{<span class="pl-smi">$seq</span><span class="pl-k">-&gt;</span>display_id()} = <span class="pl-smi">$seq</span>;
    }

    <span class="pl-k">my</span> <span class="pl-smi">$proteinOut</span> = <span class="pl-smi">$species</span> . <span class="pl-s"><span class="pl-pds">"</span>.pep.matching.fa<span class="pl-pds">"</span></span>;
    <span class="pl-k">my</span> <span class="pl-smi">$seqOut</span> = Bio::SeqIO<span class="pl-k">-&gt;</span>new(-<span class="pl-c1">file</span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>&gt;<span class="pl-smi">$proteinOut</span><span class="pl-pds">"</span></span>,
                                 -<span class="pl-c1">format</span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">'</span>fasta<span class="pl-pds">'</span></span>);

    <span class="pl-k">my</span> <span class="pl-smi">$blastResults</span> = <span class="pl-smi">$species</span> . <span class="pl-s"><span class="pl-pds">"</span>.pep.all.fa.proteinMatches<span class="pl-pds">"</span></span>;
    <span class="pl-c1">open</span>(<span class="pl-k">my</span> <span class="pl-smi">$blastFH</span>, <span class="pl-s"><span class="pl-pds">"</span>&lt;<span class="pl-pds">"</span></span>, <span class="pl-smi">$blastResults</span>) <span class="pl-k">or</span> <span class="pl-k">die</span> <span class="pl-s"><span class="pl-pds">"</span>Couldn't open <span class="pl-smi">$blastResults</span> for reading: <span class="pl-smi">$!</span><span class="pl-cce">\n</span><span class="pl-pds">"</span></span>;
    <span class="pl-k">while</span> (<span class="pl-k">my</span> <span class="pl-smi">$line</span> = &lt;<span class="pl-smi">$blastFH</span>&gt;) {
        <span class="pl-k">my</span> <span class="pl-smi">@fields</span> = <span class="pl-c1">split</span>(<span class="pl-sr"><span class="pl-pds">/</span><span class="pl-cce">\t</span><span class="pl-pds">/</span></span>, <span class="pl-smi">$line</span>);
        <span class="pl-smi">$seqOut</span><span class="pl-k">-&gt;</span>write_seq(<span class="pl-smi">$protHash</span>{<span class="pl-smi">$fields</span>[1]});
    }
}</pre></div>

<p>Now we'll set these aside:</p>

<div class="highlight highlight-bash"><pre>mkdir matchingProteins
mv <span class="pl-k">*</span>.pep.matching.fa matchingProteins/</pre></div>

<p>Exonerate protein2genome is very slow unless you change some settings around, and it seems to run faster when you separate each sequence into its own file. Using only one sequence per run also has the benefit of showing you where you left off if exonerate segfaults.</p>

<p>So we're first gonna need to separate the protein fasta files into new files, one sequence per file:</p>

<div class="highlight highlight-perl"><pre><span class="pl-c">#!/usr/bin/perl</span>

<span class="pl-c"># separateProteinsIntoIndividuals.pl</span>

<span class="pl-k">use</span> strict;
<span class="pl-k">use</span> warnings;
<span class="pl-k">use</span> Bio::SeqIO;
<span class="pl-k">use</span> Bio::SearchIO;

<span class="pl-k">my</span> <span class="pl-smi">@speciesArray</span> = (<span class="pl-s"><span class="pl-pds">"</span>Strongylocentrotus_purpuratus.GCA_000002235.2.26<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>Petromyzon_marinus.Pmarinus_7.0<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>Takifugu_rubripes.FUGU4<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>Latimeria_chalumnae.LatCha1<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>Anolis_carolinensis.AnoCar2.0<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>Xenopus_tropicalis.JGI_4.2<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>Gallus_gallus.Galgal4<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>Ornithorhynchus_anatinus.OANA5<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>Loxodonta_africana.loxAfr3<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>Sus_scrofa.Sscrofa10.2<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>Homo_sapiens.GRCh38<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>Rattus_norvegicus.Rnor_6.0<span class="pl-pds">"</span></span>);

<span class="pl-k">foreach</span> <span class="pl-k">my</span> <span class="pl-smi">$species</span> (<span class="pl-smi">@speciesArray</span>) {
    <span class="pl-c"># We'll have a different folder for each species</span>
    <span class="pl-k">unless</span> (<span class="pl-k">-d</span> <span class="pl-smi">$species</span>) {
        <span class="pl-c1">mkdir</span> <span class="pl-smi">$species</span>;
    }
    <span class="pl-c1">chdir</span> <span class="pl-smi">$species</span>;

    <span class="pl-k">my</span> <span class="pl-smi">$seqsFile</span> = <span class="pl-s"><span class="pl-pds">"</span>../<span class="pl-pds">"</span></span> . <span class="pl-smi">$species</span> . <span class="pl-s"><span class="pl-pds">"</span>.pep.matching.fa<span class="pl-pds">"</span></span>;

    <span class="pl-k">my</span> <span class="pl-smi">$seqIn</span> = Bio::SeqIO<span class="pl-k">-&gt;</span>new(-<span class="pl-c1">file</span> <span class="pl-k">=&gt;</span> <span class="pl-smi">$seqsFile</span>,
                                -<span class="pl-c1">format</span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">'</span>fasta<span class="pl-pds">'</span></span>);

    <span class="pl-k">my</span> <span class="pl-smi">$counter</span> = 0;
    <span class="pl-k">while</span> (<span class="pl-k">my</span> <span class="pl-smi">$seq</span> = <span class="pl-smi">$seqIn</span><span class="pl-k">-&gt;</span>next_seq()) {
        <span class="pl-smi">$counter</span>++;
        <span class="pl-k">my</span> <span class="pl-smi">$seqOutName</span> = <span class="pl-smi">$seq</span><span class="pl-k">-&gt;</span>display_id() . <span class="pl-s"><span class="pl-pds">"</span>.pep.fasta<span class="pl-pds">"</span></span>;
        <span class="pl-k">my</span> <span class="pl-smi">$seqOut</span> = Bio::SeqIO<span class="pl-k">-&gt;</span>new(-<span class="pl-c1">file</span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>&gt;<span class="pl-smi">$seqOutName</span><span class="pl-pds">"</span></span>,
                                     -<span class="pl-c1">format</span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">'</span>fasta<span class="pl-pds">'</span></span>);

        <span class="pl-smi">$seqOut</span><span class="pl-k">-&gt;</span>write_seq(<span class="pl-smi">$seq</span>);

    }
    <span class="pl-c1">print</span> <span class="pl-smi">$counter</span> . <span class="pl-s"><span class="pl-pds">"</span> total records processed<span class="pl-cce">\n</span><span class="pl-pds">"</span></span>;
    <span class="pl-c1">chdir</span> <span class="pl-s"><span class="pl-pds">"</span>..<span class="pl-pds">"</span></span>;
}</pre></div>

<p>Note that some mouse transcripts might have selected the same genes from the reference set as others for the best blastx hit. This means that there should be fewer actual peptide fastas than query sequences that had positive matches in the blastx search.</p>

<p>Now let's loop through all those sequences and align them to their proper genomes. The sending multiple queries to a single exonerate-server tends to make things segfault, so instead we'll instantiate exonerate-servers so that each thread gets its own.</p>

<div class="highlight highlight-perl"><pre><span class="pl-c">#!/usr/bin/perl</span>

<span class="pl-c"># exonerateP2G.pl</span>

<span class="pl-k">use</span> strict;
<span class="pl-k">use</span> warnings;
<span class="pl-k">use</span> Bio::SeqIO;
<span class="pl-k">use</span> Bio::SearchIO;
<span class="pl-k">use</span> Parallel::ForkManager;

<span class="pl-k">my</span> <span class="pl-smi">@speciesArray</span> = (<span class="pl-s"><span class="pl-pds">"</span>Strongylocentrotus_purpuratus.GCA_000002235.2.26<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>Petromyzon_marinus.Pmarinus_7.0<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>Takifugu_rubripes.FUGU4<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>Latimeria_chalumnae.LatCha1<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>Anolis_carolinensis.AnoCar2.0<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>Xenopus_tropicalis.JGI_4.2<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>Gallus_gallus.Galgal4<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>Ornithorhynchus_anatinus.OANA5<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>Loxodonta_africana.loxAfr3<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>Sus_scrofa.Sscrofa10.2<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>Homo_sapiens.GRCh38<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>Rattus_norvegicus.Rnor_6.0<span class="pl-pds">"</span></span>);


<span class="pl-k">my</span> <span class="pl-smi">$portCounter</span> = 12886; <span class="pl-c"># We'll start on port 12887 and go up 29 more</span>

<span class="pl-k">foreach</span> <span class="pl-k">my</span> <span class="pl-smi">$species</span> (<span class="pl-smi">@speciesArray</span>) {
    <span class="pl-k">my</span> <span class="pl-smi">$genomeFile</span> = <span class="pl-smi">$species</span> . <span class="pl-s"><span class="pl-pds">"</span>.dna.toplevel.trans.esi<span class="pl-pds">"</span></span>;

    <span class="pl-c"># We'll use a total of 15 possible threads for the forkmanager, because</span>
    <span class="pl-c"># each thread will initiate two processes--the exonerate server and the </span>
    <span class="pl-c"># exonerate clients. We want to use about 30 CPUs total, so set this</span>
    <span class="pl-c"># to 15.</span>
    <span class="pl-k">my</span> <span class="pl-smi">$forkManager</span> = Parallel::ForkManager<span class="pl-k">-&gt;</span>new(15);

    <span class="pl-k">foreach</span> <span class="pl-k">my</span> <span class="pl-smi">$thread</span> (0..14) {
        <span class="pl-smi">$portCounter</span>++;
        <span class="pl-smi">$forkManager</span><span class="pl-k">-&gt;</span>start <span class="pl-k">and</span> <span class="pl-k">next</span>;
        <span class="pl-c1">chdir</span>(<span class="pl-s"><span class="pl-pds">"</span>/home/evan/spliceFinder/genomes/<span class="pl-pds">"</span></span>);
        <span class="pl-c1">system</span>(<span class="pl-s"><span class="pl-pds">"</span>exonerate-server --port <span class="pl-smi">$portCounter</span> <span class="pl-smi">$genomeFile</span> &amp;<span class="pl-pds">"</span></span>);
        <span class="pl-c1">sleep</span>(30);
        <span class="pl-c1">chdir</span>(<span class="pl-s"><span class="pl-pds">"</span>proteins/matchingProteins/<span class="pl-pds">"</span></span>);
        <span class="pl-c1">chdir</span> <span class="pl-smi">$species</span>;
        <span class="pl-k">unless</span>(<span class="pl-k">-d</span> <span class="pl-s"><span class="pl-pds">"</span>exonerate<span class="pl-pds">"</span></span>) {
            <span class="pl-c1">mkdir</span> <span class="pl-s"><span class="pl-pds">"</span>exonerate<span class="pl-pds">"</span></span>;
        }

        <span class="pl-c1">opendir</span>(<span class="pl-k">my</span> <span class="pl-smi">$dirFH</span>, <span class="pl-s"><span class="pl-pds">"</span>./<span class="pl-pds">"</span></span>);
        <span class="pl-k">my</span> <span class="pl-smi">@files</span> = <span class="pl-c1">readdir</span>(<span class="pl-smi">$dirFH</span>);
        <span class="pl-c1">closedir</span>(<span class="pl-smi">$dirFH</span>);

        <span class="pl-k">my</span> <span class="pl-smi">@fastaFiles</span>;
        <span class="pl-k">foreach</span> <span class="pl-k">my</span> <span class="pl-smi">$file</span> (<span class="pl-smi">@files</span>) {
            <span class="pl-k">if</span> (<span class="pl-smi">$file</span> =~ <span class="pl-sr"><span class="pl-pds">/</span>.fasta<span class="pl-pds">/</span></span>) {
                <span class="pl-c1">push</span>(<span class="pl-smi">@fastaFiles</span>, <span class="pl-smi">$file</span>);
            }
        }

        <span class="pl-k">my</span> <span class="pl-smi">$proteinsPerThread</span> = <span class="pl-c1">scalar</span>(<span class="pl-smi">@fastaFiles</span>) / 15; <span class="pl-c"># Decide how many proteins to provide to each thread</span>

        <span class="pl-k">my</span> <span class="pl-smi">$beginning</span> = <span class="pl-smi">$thread</span> * <span class="pl-smi">$proteinsPerThread</span>;
        <span class="pl-k">my</span> <span class="pl-smi">$end</span> = (<span class="pl-smi">$thread</span>+1) * <span class="pl-smi">$proteinsPerThread</span>;
        <span class="pl-k">for</span> (<span class="pl-k">my</span> <span class="pl-smi">$fileIndex</span>=<span class="pl-smi">$beginning</span>; <span class="pl-smi">$fileIndex</span> &lt; <span class="pl-smi">$end</span>; <span class="pl-smi">$fileIndex</span>++) {
            <span class="pl-k">my</span> <span class="pl-smi">$outFileName</span> = <span class="pl-s"><span class="pl-pds">"</span>exonerate/<span class="pl-pds">"</span></span> . <span class="pl-smi">$fastaFiles</span>[<span class="pl-smi">$fileIndex</span>] . <span class="pl-s"><span class="pl-pds">"</span>.p2g.exonerate<span class="pl-pds">"</span></span>;
            <span class="pl-c1">system</span>(<span class="pl-s"><span class="pl-pds">"</span>exonerate <span class="pl-smi">$fastaFiles</span>[<span class="pl-smi">$fileIndex</span>] localhost:<span class="pl-smi">$portCounter</span> --querytype protein --targettype dna --model p2g --bestn 1 --dnawordlen 12 --fsmmemory 4096 --hspfilter 50 --geneseed 250 &gt; <span class="pl-smi">$outFileName</span><span class="pl-pds">"</span></span>);
        }
        <span class="pl-smi">$forkManager</span><span class="pl-k">-&gt;</span>finish;
    }
    <span class="pl-smi">$forkManager</span><span class="pl-k">-&gt;</span>wait_all_children;
    <span class="pl-c1">sleep</span>(120);
    <span class="pl-c1">system</span>(<span class="pl-s"><span class="pl-pds">"</span>pkill -f exonerate-server<span class="pl-pds">"</span></span>);
    <span class="pl-c1">sleep</span>(120);
}</pre></div>

<p>This takes several hours to a day to run all these, assuming all goes well and you have &gt; 30 cores to work with.</p>

<p>After this comes one of the trickier parts. We'll process all of these exonerate files to harvest the putative contiguous genomic region sequences and align to the proteins. For instance, rat protein ENSRNOP00000046335 was mapped to the rat chromosome 7 between base pairs 143497108 and 143489162. Additionally, exonerate uncovered 8 introns spread throughout the alignment. The first intron starts at about bp 143496581 and ends at bp 143495791. So, we'll designate the first intron as running from 143496581-143497108. We want to pull the rat genomic DNA sequence from 143496581-143497108 and align it to the original mouse EST sequence. </p>

<p>Let's say this exon sequence aligns at base pairs 10-537 in the mouse EST. We would then code this as rat-inferred splice sites before base 10 and after 537 in the mouse EST. We'll gather all such inferred splice sites for each EST, keeping track of which ones come from which species.</p>

<p>I'll present this all in heavily-commented code below.</p>

<div class="highlight highlight-perl"><pre><span class="pl-c">#!/usr/bin/perl</span>

<span class="pl-c"># harvestExonsAndAlign.pl</span>

<span class="pl-k">use</span> strict;
<span class="pl-k">use</span> warnings;
<span class="pl-k">use</span> Bio::SearchIO; <span class="pl-c"># &lt;= We'll use this to parse the exonerate reports</span>
<span class="pl-k">use</span> Bio::SeqIO;


<span class="pl-c"># We'll deal with all the different reference genomes one-by-one in a loop</span>
<span class="pl-k">my</span> <span class="pl-smi">@speciesArray</span> = (<span class="pl-s"><span class="pl-pds">"</span>Strongylocentrotus_purpuratus.GCA_000002235.2.26<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>Petromyzon_marinus.Pmarinus_7.0<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>Takifugu_rubripes.FUGU4<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>Latimeria_chalumnae.LatCha1<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>Anolis_carolinensis.AnoCar2.0<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>Xenopus_tropicalis.JGI_4.2<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>Gallus_gallus.Galgal4<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>Ornithorhynchus_anatinus.OANA5<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>Loxodonta_africana.loxAfr3<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>Sus_scrofa.Sscrofa10.2<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>Homo_sapiens.GRCh38<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>Rattus_norvegicus.Rnor_6.0<span class="pl-pds">"</span></span>);
<span class="pl-k">foreach</span> <span class="pl-k">my</span> <span class="pl-smi">$species</span> (<span class="pl-smi">@speciesArray</span>) {
    <span class="pl-c1">chdir</span>(<span class="pl-smi">$species</span>);

}</pre></div>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">SpliceFinder maintained by <a href="https://github.com/atcg">atcg</a></p>
        <p>Published with <a href="https://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
